<script>
  $(function () {
    Highcharts.wrap(Highcharts.Axis.prototype, 'getPlotLinePath', function(proceed) {
      var path = proceed.apply(this, Array.prototype.slice.call(arguments, 1));
      if (path) {
          path.flat = false;
      }
      return path;
    });
    $('#utilization_time_series').highcharts({
      chart: {
        type: 'spline'
      },
      title: {
        text: false
      },
      xAxis: {
        type: 'datetime',
        title: {
          text: 'Start Date'
        }
      },
      yAxis: {
        min: 0,
        title: {
          text: '% Utilization'
        },
        plotLines: [{
          color: 'red',
          value: <%= @time_series.overall_average %>,
          width: 2,
          zIndex: 5,
          label: {
            align: 'right',
            text: "<%= format_utilization(@time_series.overall_average) %>"
          }
        }]
      },
      series: [{
        name: 'Utilization',
        data: <%= raw @time_series.data %>
      }]
    });
  });
</script>
<div id="utilization_time_series" class="chart"></div>
 